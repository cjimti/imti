<!DOCTYPE html>
<html lang="en-us">
<head><head>
    <meta name="msvalidate.01" content="DBC34551F2DD1BA3DC0D62EE46D7448F" />
    <meta name="google-site-verification" content="DrtKc88u9uc7iptd4LyURAKBmFcOn7Kuk6HcRk_kNmo" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta name="description" content="A data type equivalent to super-charged spreadsheets.">
    
    <meta name="keyword"  content="Go, Kubernetes, Elasticsearch, Python, Docker, Big Data, Artificial Intelligence, Machine Learning, Blockchain">
    <link rel="shortcut icon" href="https://imti.co/img/favicon.ico">

    <title>Python Data Essentials - Pandas - IMTI - Craig Johnston</title>

    <link rel="canonical" href="https://imti.co/python-data-essentials-pandas/">
	
    
    <link rel="stylesheet" href="https://imti.co/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="https://imti.co/css/hux-blog.min.css">

    
    <link rel="stylesheet" href="https://imti.co/css/syntax.css">

    
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    
    
    <link rel="stylesheet" href="/css/imti.css">

    
    <script src="https://imti.co/js/jquery.min.js"></script>
    
    
    <script src="https://imti.co/js/bootstrap.min.js"></script>
    
    
    <script src="https://imti.co/js/hux-blog.min.js"></script>

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-5984764595236029",
            enable_page_level_ads: true
        });
    </script>

    <meta name="twitter:site" content="@cjimti">
<meta name="twitter:creator" content="@cjimti">

<meta name="twitter:description" content="A data type equivalent to super-charged spreadsheets." />
<meta name="twitter:title" content="Python Data Essentials - Pandas" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://imti.co/img/post/columns_876_438.jpg" />
<meta property="og:image" content="https://imti.co/img/post/columns_876_438.jpg" />



    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https:\/\/imti.co\/python-data-essentials-pandas\/"
  },
  "headline": "Python Data Essentials - Pandas",
  "image": [
    "https:\/\/imti.co\/img\/post\/columns_876_438.jpg"
   ],
  "datePublished": "2018-06-17T00:00:00",
  "dateModified": "2018-06-17T00:00:00",
  "author": {
    "@type": "Person",
    "name": "Craig Johnston"
  },
   "publisher": {
    "@type": "Organization",
    "name": 'imti.co",
    "logo": {
      "@type": "ImageObject",
      "url": "https:\/\/imti.co\/img\/craig_johnston_cjimti.jpg"
    }
  },
  "description": "Pandas bring Python a data type equivalent to super-charged spreadsheets. Pandas add two highly expressive data structures to Python, Series and DataFrame. Pandas Series and DataFrames provide a performant analysis and manipulation of “relational” or “labeled” data similar to relational database tables like MySQL or the rows and columns of Excel. Pandas are great for working with time series data as well as arbitrary matrix data, and unlabeled data."
}
</script>

</head></head>

<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://imti.co/">IMTI</a>
        </div>

        
        
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="https://imti.co/">Home</a>
                    </li>
                    <li>
                        <a href="https://imti.co/about/">About</a>
                    </li>
                    <li>
                        <a href="https://twitter.com/cjimti">Follow</a>
                    </li>
                    

                    
                </ul>
            </div>
        </div>
        
    </div>
    
</nav>
<script>
    
    
    
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        
            $navbar.className = " ";
            
            setTimeout(function(){
                
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>




<style type="text/css">
    header.intro-header{
        background-image: url('https://imti.co/img/post/columns.jpg')
    }
</style>
<header class="intro-header" >
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/python" title="Python">
                        Python
                        </a>
                        
                        <a class="tag" href="/tags/data" title="Data">
                        Data
                        </a>
                        
                        <a class="tag" href="/tags/data-science" title="Data Science">
                        Data Science
                        </a>
                        
                    </div>
                    <h1>Python Data Essentials - Pandas</h1>
                    <h2 class="subheading">A data type equivalent to super-charged spreadsheets.</h2>
                    <span  class="meta">Posted by Craig Johnston on Sunday, June 17, 2018
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>




<article>
    <div class="container">
        <div class="row">

            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <h5>SHARE</h5>
                <ul class="list-inline">
                    <li><div class="addthis_inline_share_toolbox"></div></li>
                </ul>

                

<p><a href="https://pandas.pydata.org/">Pandas</a> bring Python a data type equivalent to super-charged spreadsheets. Pandas add two highly expressive data structures to Python, <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.html">Series</a> and <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">DataFrame</a>. Pandas <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.html">Series</a> and <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">DataFrame</a>s provide a performant analysis and manipulation of “relational” or “labeled” data similar to relational database tables like MySQL or the rows and columns of Excel. <a href="https://pandas.pydata.org/">Pandas</a> are great for working with time series data as well as arbitrary matrix data, and unlabeled data.</p>

<p><a href="https://pandas.pydata.org/">Pandas</a> leverage <a href="/python-data-essentials-numpy/">NumPy</a> and if you are not familiar with this fundamental library for working with numbers, then I suggest you take a look at <a href="/python-data-essentials-numpy/">Python Data Essentials - NumPy</a> to get a decent footing.</p>

<aside class="toc">
    <header>
        <h2>Contents</h2>
    </header>
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#getting-started">Getting Started</a></li>
<li><a href="#series">Series</a>
<ul>
<li><a href="#accessing-and-deleting-elements">Accessing and Deleting Elements</a>
<ul>
<li><a href="#numpy-on-series-data"><a href="/python-data-essentials-numpy/">NumPy</a> on <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.html">Series</a> data.</a></li>
</ul></li>
<li><a href="#arithmetic-on-series-data">Arithmetic on Series Data</a></li>
</ul></li>
<li><a href="#dataframes"><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">DataFrames</a></a>
<ul>
<li><a href="#creating">Creating</a></li>
<li><a href="#selecting">Selecting</a></li>
<li><a href="#modifying">Modifying</a></li>
<li><a href="#sorting">Sorting</a></li>
<li><a href="#math">Math</a></li>
</ul></li>
<li><a href="#essential-python-3">Essential Python 3</a></li>
</ul></li>
</ul>
</nav>
</aside>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-5984764595236029"
     data-ad-slot="7730310582"></ins>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<p>If you want to go beyond this brief overview of <a href="https://pandas.pydata.org/">Pandas</a> I suggest the following resources:</p>

<ul>
<li><a href="http://pandas.pydata.org/pandas-docs/stable/10min.html">10 Minutes to pandas</a> - Official</li>
<li><a href="http://pandas.pydata.org/pandas-docs/stable/tutorials.html">Official Tutorials</a></li>
<li><a href="https://www.youtube.com/watch?v=Iqjy9UqKKuo">Data Analysis with Python and Pandas Tutorial Introduction</a> - Video</li>
</ul>

<h2 id="getting-started">Getting Started</h2>

<p>In this article, I&rsquo;ll be working with <a href="https://pandas.pydata.org/">Pandas</a> version 0.22.0. If you are running a newer version, there is a possibility of interfaces changing or functionality being deprecated or replaced. I these cases a quick review of the official documentation should suffice.</p>

<pre><code class="language-python">!conda list pandas
</code></pre>

<pre><code># packages in environment at /Users/cjimti/anaconda3:
#
# Name                    Version                   Build  Channel
pandas                    0.22.0           py36h0a44026_0  
</code></pre>

<h2 id="series">Series</h2>

<p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.html">Series</a> data structures support integer and label based indexing.</p>

<blockquote>
<p>One-dimensional ndarray with axis labels (including time series).</p>
</blockquote>

<ul>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.html">Series</a> official documentation</p>

<pre><code class="language-python">import pandas as pd

fields = ['Name','CPU', 'GHz', 'Cores','Ram','Own']
b1 = ['Orange Pi Plus','ARM Cortex-A7',1.536,4,1046,2]
board = pd.Series(data=b1, index = fields)

print(f'Series: \n{board}\n')
print(f'     Shape: {board.shape}')
print(f'Dimensions: {board.ndim}')
print(f'      Size: {board.size}')
</code></pre>

<p>Series:
Name     Orange Pi Plus
CPU       ARM Cortex-A7
GHz               1.536
Cores                 4
Ram                1046
Own                   2
dtype: object</p>

<pre><code> Shape: (6,)
</code></pre>

<p>Dimensions: 1
      Size: 6</p>

<pre><code class="language-python"># check for label
print(f'Do we have GPU data? {&quot;GPU&quot; in board}')
print(f'Do we have CPU data? {&quot;CPU&quot; in board}')
</code></pre>

<p>Do we have GPU data? False
Do we have CPU data? True</p></li>
</ul>

<h3 id="accessing-and-deleting-elements">Accessing and Deleting Elements</h3>

<ul>
<li><a href="http://pandas.pydata.org/pandas-docs/version/0.22/generated/pandas.DataFrame.iloc.html">pandas.DataFrame.iloc</a> - explicit selection by integer-index</li>
<li><a href="http://pandas.pydata.org/pandas-docs/version/0.22/generated/pandas.DataFrame.loc.html">pandas.DataFrame.loc</a> - explicit selection by label</li>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.drop.html">pandas.Series.drop</a> - return Series with specified index labels removed.</li>

<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/indexing.html">Indexing and Selecting Data</a> official documentation.</p>

<pre><code class="language-python">print(f'The {board[&quot;Name&quot;]} runs at {board[&quot;GHz&quot;]} GHz.')
print(f'The {board[0]} has {board[3]} cores.')
print(f'The {board[0]} has {board[-1]:,} megabytes of ram.')
</code></pre>

<p>The Orange Pi Plus runs at 1.536 GHz.
The Orange Pi Plus has 4 cores.
The Orange Pi Plus has 2 megabytes of ram.</p>

<pre><code class="language-python"># select specific columns
cc = board[[&quot;CPU&quot;,&quot;Cores&quot;]]

print(f'Series: \n{cc}\n')
print(f'     Shape: {cc.shape}')
print(f'Dimensions: {cc.ndim}')
print(f'      Size: {cc.size}')
</code></pre>

<p>Series:
CPU      ARM Cortex-A7
Cores                4
dtype: object</p>

<pre><code> Shape: (2,)
</code></pre>

<p>Dimensions: 1
      Size: 2</p>

<pre><code class="language-python"># remove a column return or inplace=True
nb = board.drop(&quot;Cores&quot;)

print(f'Series: \n{nb}\n')
print(f'     Shape: {nb.shape}')
print(f'Dimensions: {nb.ndim}')
print(f'      Size: {nb.size}')
</code></pre>

<p>Series:
Name    Orange Pi Plus
CPU      ARM Cortex-A7
GHz              1.536
Ram               1046
Own                  2
dtype: object</p>

<pre><code> Shape: (5,)
</code></pre>

<p>Dimensions: 1
      Size: 5</p>

<pre><code class="language-python">inventory = pd.Series([1,3,2],['Orange Pi Plus', 'Raspberry Pi 3', 'Asus Tinker Board'])
print(f'Series: \n{inventory}\n')
</code></pre>

<p>Series:
Orange Pi Plus       1
Raspberry Pi 3       3
Asus Tinker Board    2
dtype: int64</p>

<pre><code class="language-python">inventory = inventory.add(1)
print(f'Add 1 to all values: \n{inventory}\n')
</code></pre>

<p>Add 1 to all values:
Orange Pi Plus       2
Raspberry Pi 3       4
Asus Tinker Board    3
dtype: int64</p></li>
</ul>

<h4 id="numpy-on-series-data"><a href="/python-data-essentials-numpy/">NumPy</a> on <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.html">Series</a> data.</h4>

<pre><code class="language-python">import numpy as np
</code></pre>

<pre><code class="language-python">print(f'Square root of each item: \n{np.sqrt(inventory)}\n')
print(f'Each item to the power of 2: \n{np.power(inventory,2)}\n')
</code></pre>

<pre><code>Square root of each item: 
Orange Pi Plus       1.414214
Raspberry Pi 3       2.000000
Asus Tinker Board    1.732051
dtype: float64

Each item to the power of 2: 
Orange Pi Plus        4
Raspberry Pi 3       16
Asus Tinker Board     9
dtype: int64
</code></pre>

<pre><code class="language-python"># Orange Pi Plus and Asus Tinker Boards
inventory[['Orange Pi Plus', 'Asus Tinker Board']] * 2
</code></pre>

<pre><code>Orange Pi Plus       4
Asus Tinker Board    6
dtype: int64
</code></pre>

<h3 id="arithmetic-on-series-data">Arithmetic on Series Data</h3>

<pre><code class="language-python">containers = ['a','b','c']
items = [1,10,100]

item_containers = pd.Series(index=containers, data=items)

print(f'All: \n{item_containers}\n')
print(f'Greater than 1: \n{item_containers[item_containers &gt; 1]}\n')
</code></pre>

<pre><code>All: 
a      1
b     10
c    100
dtype: int64

Greater than 1: 
b     10
c    100
dtype: int64
</code></pre>

<pre><code class="language-python"># add 10 items to a
item_containers = item_containers.add([10,0,0])
print(f'All: \n{item_containers}\n')
</code></pre>

<pre><code>All: 
a     11
b     10
c    100
dtype: int64
</code></pre>

<pre><code class="language-python">half_containers = item_containers / 2
print(f'Half: \n{half_containers}\n')
</code></pre>

<pre><code>Half: 
a     5.5
b     5.0
c    50.0
dtype: float64
</code></pre>

<h2 id="dataframes"><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">DataFrames</a></h2>

<p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">DataFrames</a> are the central feature of <a href="https://pandas.pydata.org/">Pandas</a>, a dictionary like data object.</p>

<blockquote>
<p>Two-dimensional size-mutable, potentially heterogeneous tabular data structure with labeled axes (rows and columns). Arithmetic operations align on both row and column labels. Can be thought of as a dict-like container for Series objects. The primary pandas data structure.</p>
</blockquote>

<ul>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">pandas.DataFrame</a> official documentation.</p>

<pre><code class="language-python">import pandas as pd
</code></pre></li>
</ul>

<h3 id="creating">Creating</h3>

<p><a href="https://pandas.pydata.org/">Pandas</a> can create a <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">DataFrame</a> from a <a href="/python-data-essentials-numpy/">NumPy</a> ndarray (structured or homogeneous), dict, or another DataFrame. A DataFrame with a Python <a href="http://www.pythonforbeginners.com/dictionary/how-to-use-dictionaries-in-python">Dict</a> can contain <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.html">Series</a>, arrays, constants, or list-like objects.</p>

<p>In the example below I create a <a href="http://www.pythonforbeginners.com/dictionary/how-to-use-dictionaries-in-python">dictionary</a> that maps three indexes to three varied data sets. The fictional AI machines &lsquo;hal&rsquo;, &lsquo;johnny 5&rsquo; and &lsquo;bender&rsquo; all have different attributes with some overlap. Each of the dictionary keys contains a Pandas Series object. However, they may contain any list-like objects.</p>

<pre><code class="language-python">ai = {'hal': pd.Series(data = [100, 90], index = ['intellect', 'dangerous']),
      'johnny 5': pd.Series(data = [12, 5, 2], index = ['dangerous','humor','bending']),
      'bender': pd.Series(data = [20, 50, 50, 100], index = ['intellect', 'dangerous', 'humor', 'bending'])}

df_ai = pd.DataFrame(ai)
df_ai
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bender</th>
      <th>hal</th>
      <th>johnny 5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bending</th>
      <td>100</td>
      <td>NaN</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>dangerous</th>
      <td>50</td>
      <td>90.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>humor</th>
      <td>50</td>
      <td>NaN</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>intellect</th>
      <td>20</td>
      <td>100.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">print(f'     Shape: {df_ai.shape}')
print(f'Dimensions: {df_ai.ndim}')
print(f'      Size: {df_ai.size}')
print(f'Total NaNs: {df_ai.isnull().sum().sum()}')
print(f'NaN Counts: \n{df_ai.isnull().sum()}\n')

</code></pre>

<pre><code>     Shape: (4, 3)
Dimensions: 2
      Size: 12
Total NaNs: 3
NaN Counts: 
bender      0
hal         2
johnny 5    1
dtype: int64
</code></pre>

<pre><code class="language-python">print(f'DataFrame Values: \n{df_ai.values}\n')
</code></pre>

<pre><code>DataFrame Values: 
[[ 100.   nan    2.]
 [  50.   90.   12.]
 [  50.   nan    5.]
 [  20.  100.   nan]]
</code></pre>

<h3 id="selecting">Selecting</h3>

<p>The methods <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.mask.html">mask</a> and <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.where.html">where</a> are provided by Panda&rsquo;s <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.html">Series</a> and <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">DataFrame</a> data types. See the examples below for some simple examples of value selection using basic arithmatic expressions.</p>

<ul>
<li><a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.mask.html">pandas.DataFrame.mask</a></li>
<li><a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.where.html">pandas.DataFrame.where</a></li>
<li><a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.mask.html">pandas.Series.mask</a></li>

<li><p><a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.where.html">pandas.Series.where</a></p>

<pre><code class="language-python"># mask out any data greater than 10
df_ai.mask(df_ai &gt; 10)
</code></pre></li>
</ul>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bender</th>
      <th>hal</th>
      <th>johnny 5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bending</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>dangerous</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>humor</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>intellect</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># only return data greater than 10, otherwise NaN
df_ai.where(df_ai &gt; 10)
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bender</th>
      <th>hal</th>
      <th>johnny 5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bending</th>
      <td>100</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>dangerous</th>
      <td>50</td>
      <td>90.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>humor</th>
      <td>50</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>intellect</th>
      <td>20</td>
      <td>100.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># only return data greater than 10, otherwise 0
df_ai.where(df_ai &gt; 10, 0)
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bender</th>
      <th>hal</th>
      <th>johnny 5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bending</th>
      <td>100</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>dangerous</th>
      <td>50</td>
      <td>90.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>humor</th>
      <td>50</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>intellect</th>
      <td>20</td>
      <td>100.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="modifying">Modifying</h3>

<p>The AI bots &lsquo;hal&rsquo;, &lsquo;johnny 5&rsquo; and &lsquo;bender&rsquo; share some common attributes, however where they do not, we get <strong>nan</strong> (not a number). Running the AI bot data through any math function would be problematic with the existence of non-numbers. Pandas give us quite a few options.</p>

<p>There are many options for cleaning this data. I&rsquo;ll start with removing any rows that contain <strong>nan</strong> values. We can make these adjustments with the optional parameter <strong>inplace=True</strong> if we wanted to modify the DataFrame in place, however for the sake of examples it is better to keep the original in-tact.</p>

<pre><code class="language-python"># return a frame eliminating rows with NaN values
df_ai_common_rows = df_ai.dropna(axis=0)
df_ai_common_rows
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bender</th>
      <th>hal</th>
      <th>johnny 5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>dangerous</th>
      <td>50</td>
      <td>90.0</td>
      <td>12.0</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># return a frame eliminating rows with NaN values
df_ai_common_cols = df_ai.dropna(axis=1)
df_ai_common_cols
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bender</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bending</th>
      <td>100</td>
    </tr>
    <tr>
      <th>dangerous</th>
      <td>50</td>
    </tr>
    <tr>
      <th>humor</th>
      <td>50</td>
    </tr>
    <tr>
      <th>intellect</th>
      <td>20</td>
    </tr>
  </tbody>
</table>
</div>

<p>Depending on requirements, no data could mean zero in our scale of 0-100. While zero is not a reasonable assumption for our AI bots, it&rsquo;s an easy data fix:</p>

<pre><code class="language-python"># fill all NaNs with 0
df_ai.fillna(0)
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bender</th>
      <th>hal</th>
      <th>johnny 5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bending</th>
      <td>100</td>
      <td>0.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>dangerous</th>
      <td>50</td>
      <td>90.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>humor</th>
      <td>50</td>
      <td>0.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>intellect</th>
      <td>20</td>
      <td>100.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># forward fill rows with previous column (axis=0) data 
df_ai.fillna(method='ffill', axis=0)
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bender</th>
      <th>hal</th>
      <th>johnny 5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bending</th>
      <td>100</td>
      <td>NaN</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>dangerous</th>
      <td>50</td>
      <td>90.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>humor</th>
      <td>50</td>
      <td>90.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>intellect</th>
      <td>20</td>
      <td>100.0</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python"># forward fill rows with previous column (axis=0) data 
# then back fill
df_ai.fillna(method='ffill', axis=0).fillna(method='bfill', axis=0)
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bender</th>
      <th>hal</th>
      <th>johnny 5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bending</th>
      <td>100</td>
      <td>90.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>dangerous</th>
      <td>50</td>
      <td>90.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>humor</th>
      <td>50</td>
      <td>90.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>intellect</th>
      <td>20</td>
      <td>100.0</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>
</div>

<p>Forward (ffill) and backfilling (bfill) have far better uses in time-series data. In this case, <code>hal</code> having a danger rating of 90 should not assume that his bending ability would be 90 as well, but this example clearly illustrates the forward and backfilling capabilities of <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">DataFrame</a>&rsquo;s <a href="https://pandas.pydata.org/pandas-docs/version/0.22/generated/pandas.DataFrame.fillna.html">fillna</a> method.</p>

<p>If we needed to make assumptions regarding the ability of this team of AI bots we could assume unknown data could start as an average of known data.</p>

<pre><code class="language-python"># get the mean of data for each attribute row by column (axis=1)
df_ai.mean(axis=1)
</code></pre>

<pre><code>bending      51.000000
dangerous    50.666667
humor        27.500000
intellect    60.000000
dtype: float64
</code></pre>

<p><a href="http://pandas.pydata.org/pandas-docs/version/0.22/generated/pandas.DataFrame.apply.html">pandas.DataFrame.apply</a> method applies the return value of a function along an axis of DataFrame, axis=1 in the example below. The function given to <a href="http://pandas.pydata.org/pandas-docs/version/0.22/generated/pandas.DataFrame.apply.html">pandas.DataFrame.apply</a> is passed the row or column depending the axis specified, the function below receives rows (because axis=1 is specified) and assigns each row to the variable &ldquo;x&rdquo; in which the method &ldquo;mean&rdquo; is called and resulting data returned from the function.</p>

<p>We could have defied a named function; however this small opperation <strong>x.fillna(x.mean())</strong> is hardly worthy of such attention. Python&rsquo;s <a href="https://docs.python.org/3/tutorial/controlflow.html#lambda-expressions">lambda</a>s are one line, anonymous functions, and then used responsibly, can make the code more compact and readable at the same time.</p>

<pre><code class="language-python">clean_df_ai = df_ai.apply(lambda x: x.fillna(x.mean()),axis=1)
clean_df_ai
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bender</th>
      <th>hal</th>
      <th>johnny 5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bending</th>
      <td>100.0</td>
      <td>51.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>dangerous</th>
      <td>50.0</td>
      <td>90.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>humor</th>
      <td>50.0</td>
      <td>27.5</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>intellect</th>
      <td>20.0</td>
      <td>100.0</td>
      <td>60.0</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="sorting">Sorting</h3>

<pre><code class="language-python"># order the columns by ai bot with the highest intellect
hii = clean_df_ai.sort_values(['intellect'], axis=1, ascending=False)
hii
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hal</th>
      <th>johnny 5</th>
      <th>bender</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bending</th>
      <td>51.0</td>
      <td>2.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>dangerous</th>
      <td>90.0</td>
      <td>12.0</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>humor</th>
      <td>27.5</td>
      <td>5.0</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>intellect</th>
      <td>100.0</td>
      <td>60.0</td>
      <td>20.0</td>
    </tr>
  </tbody>
</table>
</div>

<pre><code class="language-python">print(f'The bot with the highest intelligence is {hii.columns[0]}.')
print(f'The bot with the lowest intelligence is {hii.columns[-1]}.')
</code></pre>

<pre><code>The bot with the highest intelligence is hal.
The bot with the lowest intelligence is bender.
</code></pre>

<p>I doubt that <code>johnny 5</code> is more intelligent than <code>bender</code> but his data was unknown and therefore derived by using a mean, so the score is mathematically correct.</p>

<p>I won&rsquo;t attempt even to scratch the surface of sorting functions and their parameters provided by <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">DataFrame</a>s. This article is only intended to give you a taste and get you going.</p>

<h3 id="math">Math</h3>

<p>Use <a href="/python-data-essentials-numpy/">NumPy</a> to perform any number of arithmetic operations on the values of a <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html">DataFrames</a>. I suggest you take a look at my article <a href="/python-data-essentials-numpy/">Python Data Essentials - Pandas</a> for an overview of this compelling data science library.</p>

<h2 id="essential-python-3">Essential Python 3</h2>

<p>A lot of data science in done in <a href="/golang-to-jupyter/">Jupyter Notbooks</a> and libraries like <a href="/python-data-essentials-numpy/">NumPy</a> make developing reports or documenting numerical processes. However if you a software developer like me, this code needs to run in a script on a server, in Amazon&rsquo;s <a href="https://docs.aws.amazon.com/lambda/latest/dg/python-programming-model-handler-types.html">Lambda Function Handler</a> or even <a href="https://kubeless.io/">kubeless</a> in a custom <a href="/hobby-cluster/">kubernetes</a> cluster.</p>

<p>Check out my article on <a href="/essential-python3/">Essential Python 3</a> for a clean boilerplate script template to get you going.</p>


                <p>
                   <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Python Data Essentials - Pandas: A data type equivalent to super-charged spreadsheets.</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="https://imti.co/" property="cc:attributionName" rel="cc:attributionURL">Craig Johnston</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
                    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>
                </p>

                
                <hr>
                <h5>SHARE</h5>
                <ul class="list-inline">
                    <li><div class="addthis_inline_share_toolbox"></div></li>
                </ul>

                <h5>FOLLOW</h5>
                <ul class="list-inline">
                    <li><div class="addthis_inline_follow_toolbox"></div></li>
                </ul>

            </div>
            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                        
                        
                        
                        <a href="/tags/blockchain" title="blockchain">
                        blockchain
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/data" title="data">
                        data
                        </a>
                        
                        
                        
                        <a href="/tags/data-science" title="data-science">
                        data-science
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/development" title="development">
                        development
                        </a>
                        
                        
                        
                        <a href="/tags/devops" title="devops">
                        devops
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/docker" title="docker">
                        docker
                        </a>
                        
                        
                        
                        <a href="/tags/elasticsearch" title="elasticsearch">
                        elasticsearch
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/golang" title="golang">
                        golang
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/ingress" title="ingress">
                        ingress
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/kubectl" title="kubectl">
                        kubectl
                        </a>
                        
                        
                        
                        <a href="/tags/kubernetes" title="kubernetes">
                        kubernetes
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/microservices" title="microservices">
                        microservices
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/python" title="python">
                        python
                        </a>
                        
                        
                        
                        <a href="/tags/raspberry-pi" title="raspberry-pi">
                        raspberry-pi
                        </a>
                        
                        
                        
                        <a href="/tags/security" title="security">
                        security
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/utils" title="utils">
                        utils
                        </a>
                        
                        
                        
                        
                        
                        
                    </div>
                </section>

                
                <hr>
                <h5>RELATED</h5>
                <ul class="list-inline">
                    
                </ul>
            </div>
        </div>
    </div>
</article>




<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                   
                   <li>
                       <a href="" rel="alternate" type="application/rss+xml" title="IMTI" >
                           <span class="fa-stack fa-lg">
                               <i class="fa fa-circle fa-stack-2x"></i>
                               <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                           </span>
                       </a>
                   </li>
                   
                    
                    <li>
                        <a href="mailto:cjimti@gmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    <li>
                        <a href="https://twitter.com/cjimti">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    

                    

		    
                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/cjimti">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    <li>
                        <a target="_blank" href="https://www.linkedin.com/in/cjimti/">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                </ul>

                
                
            </div>
        </div>
    </div>
</footer>




<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>






<script>
    
    if($('#tag_cloud').length !== 0){
        async("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>


<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5b905a667cf4d77c"></script>



    
        
        
    





<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-78786435-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



</body>
</html>
