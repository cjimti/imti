<!DOCTYPE html>
<html lang="en-us">
<head><head>
    <meta name="google-site-verification" content="" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta name="description" content="I lead a talented team of software development and creative engineers, covering many industries looking to collect, analyze, move, buffer, queue, process and present data in significant ways. My expertise and that of my team revolve around microservices, artificial intelligence, algorithms, machine learning and blockchain technologies.">
    
    <meta name="keyword"  content="Go, Kubernetes, Elasticsearch, Python, Docker, Big Data, Artificial Intelligence, Machine Learning, Blockchain">
    <link rel="shortcut icon" href="https://mk2.imti.co/img/favicon.ico">

    <title>Helm on Custom Kubernetes - IMTI - Craig Johnston</title>

    <link rel="canonical" href="https://mk2.imti.co/helm-on-custom-cluster/">
	
    
    <link rel="stylesheet" href="https://mk2.imti.co/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="https://mk2.imti.co/css/hux-blog.min.css">

    
    <link rel="stylesheet" href="https://mk2.imti.co/css/syntax.css">

    
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    
    
    <link rel="stylesheet" href="/css/imti.css">

    
    <script src="https://mk2.imti.co/js/jquery.min.js"></script>
    
    
    <script src="https://mk2.imti.co/js/bootstrap.min.js"></script>
    
    
    <script src="https://mk2.imti.co/js/hux-blog.min.js"></script>

    <meta name="twitter:site" content="@cjimti">
<meta name="twitter:creator" content="@cjimti">

<meta name="twitter:description" content="Helm is the official package manager for Kubernetes. If you are looking to start using Helm or want to test its capabilities, I suggest you set up a Production Hobby Cluster. This article is a continuation of the Production Hobby Cluster configuration but should be entirely useful on its own.
 From https://github.com/kubernetes/helm - Helm has two parts: a client (helm) and a server (tiller) - Tiller runs inside of your Kubernetes cluster and manages releases (installations) of your charts." />
<meta name="twitter:title" content="Helm on Custom Kubernetes" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://mk2.imti.co/img/post/helm_876_438.jpg" />
<meta property="og:image" content="https://mk2.imti.co/img/post/helm_876_438.jpg" />



    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://mk2.imti.co/helm-on-custom-cluster/"
  },
  "headline": "Helm on Custom Kubernetes",
  "image": [
    "https://mk2.imti.co/img/post/helm_876_438.jpg"
   ],
  "datePublished": "2018-05-17T00:00:00",
  "dateModified": "2018-05-17T00:00:00",
  "author": {
    "@type": "Person",
    "name": "Craig Johnston"
  },
   "publisher": {
    "@type": "Organization",
    "name": 'imti.co",
    "logo": {
      "@type": "ImageObject",
      "url": "https://mk2.imti.co/img/craig_johnston_cjimti.jpg"
    }
  },
  "description": "Helm is the official package manager for Kubernetes. If you are looking to start using Helm or want to test its capabilities, I suggest you set up a Production Hobby Cluster. This article is a continuation of the Production Hobby Cluster configuration but should be entirely useful on its own.
 From https://github.com/kubernetes/helm - Helm has two parts: a client (helm) and a server (tiller) - Tiller runs inside of your Kubernetes cluster and manages releases (installations) of your charts."
}
</script>

</head></head>

<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://mk2.imti.co/">IMTI</a>
        </div>

        
        
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="https://mk2.imti.co/">Home</a>
                    </li>
                    <li>
                        <a href="https://mk2.imti.co/about/">About</a>
                    </li>
                    <li>
                        <a href="https://twitter.com/cjimti">Follow</a>
                    </li>
                    

                    
                </ul>
            </div>
        </div>
        
    </div>
    
</nav>
<script>
    
    
    
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        
            $navbar.className = " ";
            
            setTimeout(function(){
                
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>




<style type="text/css">
    header.intro-header{
        background-image: url('https://mk2.imti.co/img/post/helm.jpg')
    }
</style>
<header class="intro-header" >
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/kubernetes" title="Kubernetes">
                        Kubernetes
                        </a>
                        
                        <a class="tag" href="/tags/helm" title="helm">
                        helm
                        </a>
                        
                    </div>
                    <h1>Helm on Custom Kubernetes</h1>
                    <h2 class="subheading">Kubernetes package management.</h2>
                    <span  class="meta">Posted by Craig Johnston on Thursday, May 17, 2018
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>




<article>
    <div class="container">
        <div class="row">

            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <h5>SHARE</h5>
                <ul class="list-inline">
                    <li><div class="addthis_inline_share_toolbox"></div></li>
                </ul>

                

<p><a href="https://helm.sh/">Helm</a> is the official package manager for <a href="https://kubernetes.io/">Kubernetes</a>. If you are looking to start using <a href="https://helm.sh/">Helm</a> or want to test its capabilities, I suggest you set up a <a href="/hobby-cluster/">Production Hobby Cluster</a>. This article is a continuation of the <a href="/hobby-cluster/">Production Hobby Cluster</a> configuration but should be entirely useful on its own.</p>

<blockquote>
<p>From <a href="https://github.com/kubernetes/helm">https://github.com/kubernetes/helm</a>
- Helm has two parts: a client (helm) and a server (tiller)
- Tiller runs inside of your Kubernetes cluster and manages releases (installations) of your charts.
 - Helm runs on your laptop, CI/CD, or wherever you want it to run.
 - Charts are Helm packages that contain at least two things:
 - A description of the package (Chart.yaml)
 - One or more templates, which contain Kubernetes manifest files
 - Charts can be stored on disk, or fetched from remote chart repositories (like Debian or RedHat packages)</p>
</blockquote>

<p>Start with installing <a href="https://helm.sh/">Helm</a> on your local workstation. Read the <a href="https://github.com/kubernetes/helm/blob/master/docs/install.md">Helm installation instructions</a> or merely follow along below.</p>

<pre><code class="language-bash"># on MacOS using homebrew (http://brew.sh)
brew install kubernetes-helm

# on windows using https://chocolatey.org/
choco install kubernetes-helm
</code></pre>

<p>Since our <a href="/hobby-cluster/">Production Hobby Cluster</a> uses <a href="https://kubernetes.io/docs/admin/authorization/rbac/">RBAC</a> Roles, we start by adding a <a href="https://kubernetes.io/docs/admin/service-accounts-admin/">ServiceAccount</a> called <strong>tiller</strong>. Tiller is Kubernetes service that manages <a href="https://helm.sh/">Helm</a> installs on the cluster.</p>

<p>The following configuration creates a <a href="https://kubernetes.io/docs/admin/service-accounts-admin/">ServiceAccount</a> named <strong>tiller</strong> and a <a href="https://kubernetes.io/docs/admin/authorization/rbac/#rolebinding-and-clusterrolebinding">ClusterRoleBinding</a> between the new <strong>tiller</strong> account and the <strong>cluster-admin</strong> role. Of course, you can define your own <a href="https://kubernetes.io/docs/admin/authorization/rbac/#role-and-clusterrole">Role</a> and permissions, however, the <strong>cluster-admin</strong> role has admin access, and that is what we want for a <a href="/hobby-cluster/">Production Hobby Cluster</a>. Permissions can always become more restrictive in the future should our hobby become more sophisticated.</p>

<script src="https://gist.github.com/cjimti/9fab60c0b21a97cbe15688f5e28d940f.js"></script>

<p>You can apply the configuration with the following command:</p>

<pre><code class="language-bash">kubectl create -f https://gist.githubusercontent.com/cjimti/9fab60c0b21a97cbe15688f5e28d940f/raw/29cbeff70bc528e5212ebc3f63e08fb5a24d5ecd/00-tiller-rbac.yml
</code></pre>

<p>Next initialize <a href="https://helm.sh/">Helm</a> while specifying the <a href="https://kubernetes.io/docs/admin/service-accounts-admin/">ServiceAccount</a> to use. Use the new <strong>tiller</strong>  <a href="https://kubernetes.io/docs/admin/service-accounts-admin/">ServiceAccount</a> we setup above.</p>

<pre><code class="language-bash">helm init --service-account tiller
</code></pre>

<p>To see what <a href="https://helm.sh/">Helm</a> just installed on your cluster run:</p>

<pre><code class="language-bash">kubectl get all -l app=helm -n kube-system
</code></pre>

<p>As this point you can see a <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">Deployment</a>, a <a href="https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/">ReplicaSet</a>, a <a href="https://kubernetes.io/docs/concepts/workloads/pods/pod/">Pod</a> and a <a href="https://kubernetes.io/docs/concepts/services-networking/service/">Service</a> named <strong>tiller-deploy</strong> in the <strong>kube-system</strong> namespace.</p>

<hr />

<p>If in a few days you find yourself setting up a cluster in Japan or Germany on <a href="https://www.linode.com/?r=848a6b0b21dc8edd33124f05ec8f99207ccddfde">Linode</a>, and another two in Australia and France on <a href="https://www.vultr.com/?ref=7418713">vultr</a>, then you may have just joined the PHC (Performance <a href="/hobby-cluster/">Hobby Cluster</a>s) club. Some people tinker late at night on their truck, we benchmark and test the resilience of node failures on our overseas, budget kubernetes clusters. It&rsquo;s all about going big, on the cheap.</p>

<p><a href="https://amzn.to/2IOe8Yu"><img src="https://github.com/cjimti/mk/raw/master/images/content/k8s-tshirt-banner.jpg" alt="k8s performance hobby clusters" /></a></p>

<h2 id="resources">Resources</h2>

<ul>
<li><a href="https://www.linode.com/?r=848a6b0b21dc8edd33124f05ec8f99207ccddfde">Linode</a> hosting.</li>
<li><a href="https://m.do.co/c/97b733e7eba4">Digital Ocean</a> hosting.</li>
<li><a href="https://www.vultr.com/?ref=7418713">Vultr</a> hosting.</li>
</ul>


                
                <hr>
                <h5>SHARE</h5>
                <ul class="list-inline">
                    <li><div class="addthis_inline_share_toolbox"></div></li>
                </ul>

                <h5>FOLLOW</h5>
                <ul class="list-inline">
                    <li><div class="addthis_inline_follow_toolbox"></div></li>
                </ul>

            </div>
            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/data" title="Data">
                        Data
                        </a>
                        
                        
                        
                        <a href="/tags/data-science" title="Data Science">
                        Data Science
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/devops" title="DevOps">
                        DevOps
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/docker" title="Docker">
                        Docker
                        </a>
                        
                        
                        
                        <a href="/tags/elasticsearch" title="Elasticsearch">
                        Elasticsearch
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/golang" title="Golang">
                        Golang
                        </a>
                        
                        
                        
                        <a href="/tags/ingress" title="Ingress">
                        Ingress
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/kubernetes" title="Kubernetes">
                        Kubernetes
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/microservices" title="Microservices">
                        Microservices
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/python" title="Python">
                        Python
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/security" title="Security">
                        Security
                        </a>
                        
                        
                        
                        
                        
                        <a href="/tags/utils" title="Utils">
                        Utils
                        </a>
                        
                        
                        
                        
                        
                        
                        
                        <a href="/tags/kubectl" title="kubectl">
                        kubectl
                        </a>
                        
                        
                        
                        
                        
                        
                    </div>
                </section>

                
                <hr>
                <h5>RELATED</h5>
                <ul class="list-inline">
                    
                </ul>
            </div>
        </div>
    </div>
</article>




<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                   
                   <li>
                       <a href="" rel="alternate" type="application/rss+xml" title="IMTI" >
                           <span class="fa-stack fa-lg">
                               <i class="fa fa-circle fa-stack-2x"></i>
                               <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                           </span>
                       </a>
                   </li>
                   
                    
                    <li>
                        <a href="mailto:cjimti@gmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    <li>
                        <a href="https://twitter.com/cjimti">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    

                    

		    
                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/cjimti">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    <li>
                        <a target="_blank" href="https://www.linkedin.com/in/cjimti/">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                </ul>
		<p class="copyright text-muted">
            Copyright &copy; <a href="https://www.linkedin.com/in/cjimti/">Craig Johnston</a> , 2018
                </p>
            </div>
        </div>
    </div>
</footer>




<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>






<script>
    
    if($('#tag_cloud').length !== 0){
        async("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>


<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5b905a667cf4d77c"></script>



    
        
        
    





</body>
</html>
